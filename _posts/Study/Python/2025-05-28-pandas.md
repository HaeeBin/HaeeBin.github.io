---
title: "Pandas"
excerpt: "Pandas, Data Processing, Python"

categories:
  - Python
tags:
  - [Python, Pandas, ê¸°ì´ˆ]

toc: true
toc_sticky: true

date: 2025-05-28
last_modified_at: 2025-05-28
---
# ğŸ¼ Pandas
## 1. pandasë€?
- ë°ì´í„° ì¡°ì‘, ë¶„ì„, ì „ì²˜ë¦¬, ì‹œê°í™” ë“±ì„ í¸ë¦¬í•˜ê²Œ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” íŒŒì´ì¬ ë¼ì´ë¸ŒëŸ¬ë¦¬
- pandasë¥¼ ì‚¬ìš©í•˜ë©´ í–‰ê³¼ ì—´ë¡œ ì´ë£¨ì–´ì§„ ë°ì´í„° ê°ì²´ë¥¼ ë§Œë“¤ì–´ ë‹¤ë£° ìˆ˜ ìˆìŒ
- ë˜í•œ ì•ˆì •ì ìœ¼ë¡œ ëŒ€ìš©ëŸ‰ì˜ ë°ì´í„°ë“¤ì„ ì²˜ë¦¬í•˜ëŠ”ë° ë§¤ìš° í¸ë¦¬í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬

<br><br>

## 2. pandas ìë£Œêµ¬ì¡°
### (1) Series (1ì°¨ì›)
- ê°’ê³¼ ì¸ë±ìŠ¤ë¡œ êµ¬ì„±ì´ ë˜ì–´ìˆìŒ
- ê°’ì€ numpy ë°°ì—´. ì¸ë±ìŠ¤ëŠ” ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ìë™ ë¶€ì—¬ë˜ëŠ” ìˆ«ì.
- ì¸ë±ìŠ¤ê°€ ì •ìˆ˜ì¼ í•„ìš”ëŠ” ì—†ìŒ.

```python
import pandas as pd

# ex1) ì¸ë±ìŠ¤ ì§€ì •
s = pd.Series([90, 85, 70], index=["ì² ìˆ˜", "ì˜í¬", "ë¯¼ìˆ˜"])
print(s)

####### ê²°ê³¼ #######
# ì² ìˆ˜    90
# ì˜í¬    85
# ë¯¼ìˆ˜    70
# dtype: int64


# ex2) ì¸ë±ìŠ¤ ì§€ì • x
data = pd.Series([0.25, 0.5, 0.75, 1.0])
print(data)

####### ê²°ê³¼ #######
# 0    0.25
# 1    0.50
# 2    0.75
# 3    1.00
# dtype: float64
```

<br><br>

#### Series ì ‘ê·¼ ë°©ë²•

| ë°©ë²• | ì„¤ëª… | ì˜ˆì‹œ | ê²°ê³¼ |
| ---- | --- | ---- | ---- |
| `s[0]` | ìœ„ì¹˜ ê¸°ë°˜ ì ‘ê·¼ | `s[0]` | 100 |
| `s["ì˜ì–´"]` | ë¼ë²¨(ì´ë¦„) ê¸°ë°˜ ì ‘ê·¼ | `s["ì˜ì–´"]` | 85 |
| `s.loc["ìˆ˜í•™"]` | ëª…ì‹œì  ë¼ë²¨ ì ‘ê·¼ | `s.loc["ìˆ˜í•™"]` | 90 |
| `s.iloc[2]` | ëª…ì‹œì  ìœ„ì¹˜ ì ‘ê·¼ | `s.iloc[2]` | 90 |

<br><br>

### (2) DataFrame (2ì°¨ì›, í–‰ê³¼ ì—´)
- ì—‘ì…€ ì‹œíŠ¸ì²˜ëŸ¼ í–‰ê³¼ ì—´ë¡œ êµ¬ì„±ëœ í‘œ
- Seriesê°€ ì—¬ëŸ¬ ê°œ ëª¨ì¸ í˜•íƒœ

```python
import pandas as pd

# ex1) 
people = {
    'california': 11,
    'texas': 22,
    'new york': 33,
    'florida': 44
}

area = {
    'california': 55,
    'texas': 66,
    'new york': 77,
    'florida': 88
}

area_s = pd.Series(area)
population_s = pd.Series(population)

states = pd.DataFrame({'population': population, 'area': area})
print(states)

####### ê²°ê³¼ #######
#             population   area
# california   11          55
# texas        22          66
# new york     33          77
# florida      44          88


# ex2) 
data = {
    "ì´ë¦„": ["ì² ìˆ˜", "ì˜í¬", "ë¯¼ìˆ˜"],
    "êµ­ì–´": [100, 80, 90],
    "ì˜ì–´": [85, 90, 95]
}
df = pd.DataFrame(data)
print(df)

####### ê²°ê³¼ #######
#    ì´ë¦„   êµ­ì–´  ì˜ì–´
# 0  ì² ìˆ˜  100  85
# 1  ì˜í¬   80  90
# 2  ë¯¼ìˆ˜   90  95
```

<br><br>

#### DataFrame ì ‘ê·¼ ë°©ë²•
##### ğŸ“Œ ì—´(Column) ì ‘ê·¼

| ë°©ë²• | ì„¤ëª… | ì˜ˆì‹œ | ê²°ê³¼ |
| ---- | --- | ---- | ---- |
| `df["ì´ë¦„"]` | íŠ¹ì • ì—´ ì¡°íšŒ | `df["ì´ë¦„"]` | Series í˜•íƒœë¡œ "ì² ìˆ˜", "ì˜í¬", "ë¯¼ìˆ˜" |
| `df.ì´ë¦„` | ì†ì„±ì²˜ëŸ¼ ì—´ ì ‘ê·¼ (ë‹¨, ì´ë¦„ì— ê³µë°± ì—†ì„ ë•Œë§Œ) | `df.ì´ë¦„` | ìœ„ì™€ ê°™ì€ ê²°ê³¼ |
| `df[["ì´ë¦„", "ì˜ì–´"]]` | ì—¬ëŸ¬ ì—´ ì¡°íšŒ | `df[["ì´ë¦„", "ì˜ì–´"]]` | DataFrame ë°˜í™˜ |

<br>

##### ğŸ“Œ í–‰(Row) ì ‘ê·¼

| ë°©ë²• | ì„¤ëª… | ì˜ˆì‹œ | ê²°ê³¼ |
| ---- | --- | ---- | ---- |
| `df.iloc[0]` | ì²« ë²ˆì§¸ í–‰ (0ë²ˆ ì¸ë±ìŠ¤) | `df.iloc[0]` | ì² ìˆ˜ì˜ ì „ì²´ ì •ë³´ (Series) |
| `df.loc[1]` | ì¸ë±ìŠ¤ 1ë²ˆ í–‰ | `df.loc[1]` | ì˜í¬ì˜ ì •ë³´ (Series) |
| `df.iloc[1:3]` | ìŠ¬ë¼ì´ì‹±ìœ¼ë¡œ ì—¬ëŸ¬ í–‰ | `df.iloc[1:3]` | ì˜í¬, ë¯¼ìˆ˜ (DataFrame) |

<br>

##### ğŸ“Œ í–‰ + ì—´ ë™ì‹œì— ì ‘ê·¼

| ë°©ë²• | ì„¤ëª… | ì˜ˆì‹œ |
| ---- | --- | ---- |
| `df.loc[0, "ì˜ì–´"]` | 0ë²ˆ í–‰ì˜ ì˜ì–´ ì ìˆ˜ | `85` |
| `df.iloc[2, 1]` | 2ë²ˆì§¸ í–‰, 1ë²ˆì§¸ ì—´ â†’ êµ­ì–´ ì ìˆ˜ | `90` |
| `df.loc[:, "êµ­ì–´"]` | ëª¨ë“  í–‰ì˜ êµ­ì–´ ì ìˆ˜ | Series ë°˜í™˜ |

### (3) pandas ê¸°ë³¸ ì •ë³´ í™•ì¸í•˜ê¸°
- êµ¬ì¡°ì™€ ë‚´ìš©ì´ ì–´ë–¤ì§€ í™•ì¸í•˜ëŠ” ë©”ì†Œë“œë“¤

| í•­ëª© | ì„¤ëª… | í•¨ìˆ˜ |
| ---- | ---- | ---- |
| ë°ì´í„° ëª¨ì–‘(í¬ê¸°) | í–‰, ì—´ | `df.shape` |
| ì»¬ëŸ¼ ì´ë¦„ | ì—´ì˜ ì´ë¦„ë“¤ | `df.columns` |
| ì¸ë±ìŠ¤ | í–‰ì˜ ë²ˆí˜¸ ë˜ëŠ” ë¼ë²¨ | `df.index` |
| ë°ì´í„° íƒ€ì… | ê° ì—´ì´ ìˆ«ìì¸ì§€, ë¬¸ìì—´ì¸ì§€ | `df.dtypes` |
| ê°„ëµí•œ ì •ë³´ | ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰, null ë“± | `df.info()` | 
| í†µê³„ ìš”ì•½ | í‰ê· , í‘œì¤€í¸ì°¨, ìµœëŒ€ê°’ ë“± | `df.describe()` |
| ìƒ˜í”Œ ë°ì´í„° | ì•/ë’¤ ëª‡ ì¤„ë§Œ í™•ì¸ | `df.head(n) # ìƒìœ„ ní–‰`, `df.tail(n) # í•˜ìœ„ ní–‰` |

<br><br>

## 3. íŒŒì¼ ë‹¤ë£¨ê¸°
### (1) CSV íŒŒì¼ ë‹¤ë£¨ê¸°

```python
df = pd.read_csv("datasets/employees.csv") 
print("ê¸°ë³¸ CSV ì½ê¸°:")
print(df.head())  # ìƒìœ„ 5ê°œ í–‰ ì¶œë ¥

# íŠ¹ì • ì—´ë§Œ ë¶ˆëŸ¬ì˜¤ê¸° + ìƒìœ„ 10ê°œ í–‰ë§Œ ì½ê¸°
df_limited = pd.read_csv("datasets/employees.csv", usecols=['ì´ë¦„', 'ì—°ë´‰'], nrows=10)
print("\nì„ íƒí•œ ì»¬ëŸ¼ê³¼ 10ê°œ í–‰ë§Œ:")
print(df_limited)

# ì €ì¥: ê¸°ì¡´ DataFrameì„ CSV íŒŒì¼ë¡œ ì €ì¥
df.to_csv("datasets/employees_saved.csv", index=False, encoding='utf-8-sig')
# index = False í•˜ë©´ indexë¥¼ ì €ì¥í•˜ì§€ ì•ŠìŒ
```

<br><br>

### (2) Excel íŒŒì¼ ë‹¤ë£¨ê¸°

```python
# Excel íŒŒì¼ ì½ê¸°
try:
    df = pd.read_excel('datasets/employees.xlsx', sheet_name='ì§ì›ì •ë³´')
    print("\nExcelì—ì„œ ì½ì€ ë°ì´í„°:")
    print(df.head())
except ImportError:
    print("â— openpyxl ë˜ëŠ” xlrd íŒ¨í‚¤ì§€ê°€ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.")
    print("pip install openpyxl ë¡œ ì„¤ì¹˜í•˜ì„¸ìš”.")

# ìƒˆë¡œìš´ ì»¬ëŸ¼ ì¶”ê°€ (ì˜ˆ: ì—°ë´‰(ë§Œì›))
df['ì—°ë´‰_ë§Œì›'] = df['ì—°ë´‰'] // 10000

# ì¡°ê±´ ì»¬ëŸ¼ ì¶”ê°€
df['ê³ ì—°ë´‰ì'] = df['ì—°ë´‰'] > 4000

# ìˆ˜ì •ëœ DataFrame ì¶œë ¥
print("âœï¸ ìˆ˜ì •ëœ DataFrame:")
print(df)

# ìˆ˜ì •ëœ ë°ì´í„°ë¥¼ ìƒˆ Excel íŒŒì¼ë¡œ ì €ì¥
df.to_excel('datasets/employees_updated.xlsx', index=False, sheet_name='ì—…ë°ì´íŠ¸ëœ ì§ì› ì •ë³´')
```

<br><br>

#### ì—¬ëŸ¬ ì‹œíŠ¸ë¡œ ì €ì¥í•˜ê¸° (ExcelWriter)

```python
with pd.ExcelWriter('datasets/employees_multi.xlsx', engine='openpyxl') as writer:
    df.to_excel(writer, sheet_name='ì§ì›ì •ë³´')
    df.describe().to_excel(writer, sheet_name='ìš”ì•½í†µê³„')
```

<br><br>

## 4. ë°ì´í„° ì¡°ì‘

| ì¡°ì‘ | ì˜ˆì‹œ | ë°˜í™˜ íƒ€ì… |
| --- | --- | ------ |
| ë‹¨ì¼ ì»¬ëŸ¼ ì„ íƒ | `df['ì»¬ëŸ¼ëª…']` | Series |
| ì—¬ëŸ¬ ì»¬ëŸ¼ ì„ íƒ | `df[['ì»¬ëŸ¼ëª…1', 'ì»¬ëŸ¼ëª…2']]` | DataFrame |
| ì¡°ê±´ í•„í„°ë§ | `df[df['ì»¬ëŸ¼ëª…'] >= ê°’]` | DataFrame |
| ì»¬ëŸ¼ ì¶”ê°€ | `df['ì»¬ëŸ¼ëª…'] = ...` | DataFrame | 
| ì •ë ¬ | `df.sort_values('ì»¬ëŸ¼ëª…')` | DataFrame |

<br><br>

```python
import pandas as pd

data = {
    'ì œí’ˆëª…': ['ë¬´ì„  ë§ˆìš°ìŠ¤', 'ê²Œì´ë° í‚¤ë³´ë“œ', 'USB-C í—ˆë¸Œ', 'ì›¹ìº ', 'ëª¨ë‹ˆí„°'],
    'ì¹´í…Œê³ ë¦¬': ['ì£¼ë³€ê¸°ê¸°', 'ì£¼ë³€ê¸°ê¸°', 'ì•¡ì„¸ì„œë¦¬', 'ì£¼ë³€ê¸°ê¸°', 'ë””ìŠ¤í”Œë ˆì´'],
    'ê°€ê²©': [25000, 55000, 32000, 48000, 200000],
    'ì¬ê³ ìˆ˜ëŸ‰': [150, 80, 200, 60, 30]
}

df = pd.DataFrame(data)
```

<br><br>

### (1) ì»¬ëŸ¼ ì„ íƒê³¼ ì¶”ê°€

```python
# ë‹¨ì¼ ì»¬ëŸ¼ ì„ íƒ (Series ë°˜í™˜)
product_names = df['ì œí’ˆëª…']
print("ğŸ“‹ ì œí’ˆëª… ëª©ë¡:")
print(product_names)
print(f"íƒ€ì…: {type(product_names)}")  # Series

# ì—¬ëŸ¬ ì»¬ëŸ¼ ì„ íƒ (DataFrame ë°˜í™˜)
subset = df[['ì œí’ˆëª…', 'ê°€ê²©']]
print("\nğŸ’° ì œí’ˆëª…ê³¼ ê°€ê²©:")
print(subset)
print(f"íƒ€ì…: {type(subset)}")  # DataFrame

# ìƒˆ ì»¬ëŸ¼ ì¶”ê°€: ê°€ê²©ì´ 5ë§Œì› ì´ìƒì¸ì§€ ì—¬ë¶€
df['í”„ë¦¬ë¯¸ì—„'] = df['ê°€ê²©'] >= 50000
print("\nğŸ·ï¸ í”„ë¦¬ë¯¸ì—„ ì—¬ë¶€ ì»¬ëŸ¼ ì¶”ê°€:")
print(df)
```

<br><br>

### (2) ì¡°ê±´ í•„í„°ë§

```python
# ê°€ê²©ì´ 4ë§Œì› ì´ìƒì¸ ì œí’ˆ
expensive_products = df[df['ê°€ê²©'] >= 40000]
print("ğŸ’¸ ê°€ê²© 4ë§Œì› ì´ìƒ ì œí’ˆ:")
print(expensive_products)

# ì¬ê³ ê°€ 100ê°œ ì´ìƒì¸ ì œí’ˆë§Œ í•„í„°ë§
in_stock = df[df['ì¬ê³ ìˆ˜ëŸ‰'] >= 100]
print("\nğŸ“¦ ì¬ê³  100ê°œ ì´ìƒ:")
print(in_stock)

# íŠ¹ì • ì¹´í…Œê³ ë¦¬ í•„í„°ë§ (isin ì‚¬ìš©)
peripherals = df[df['ì¹´í…Œê³ ë¦¬'].isin(['ì£¼ë³€ê¸°ê¸°'])]
print("\nğŸ–¥ï¸ ì£¼ë³€ê¸°ê¸° ì¹´í…Œê³ ë¦¬ ì œí’ˆ:")
print(peripherals)
```

<br><br>

### (3) ì •ë ¬

```python
# ê°€ê²© ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬
sorted_by_price = df.sort_values('ê°€ê²©')
print("ğŸ”½ ê°€ê²© ë‚®ì€ ìˆœ ì •ë ¬:")
print(sorted_by_price)

# ì¬ê³ ìˆ˜ëŸ‰ ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
sorted_by_stock = df.sort_values('ì¬ê³ ìˆ˜ëŸ‰', ascending=False)
print("\nğŸ”¼ ì¬ê³  ë§ì€ ìˆœ ì •ë ¬:")
print(sorted_by_stock)

# ë³µí•© ì •ë ¬: ì¹´í…Œê³ ë¦¬ë³„ë¡œ ë¬¶ê³  ê°€ê²© ë†’ì€ ìˆœìœ¼ë¡œ
multi_sorted = df.sort_values(['ì¹´í…Œê³ ë¦¬', 'ê°€ê²©'], ascending=[True, False])
print("\nğŸ§¾ ì¹´í…Œê³ ë¦¬ë³„ ê°€ê²© ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬:")
print(multi_sorted)
```

<br><br>